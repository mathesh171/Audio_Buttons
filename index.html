<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="assert/wave-sound.png" />
    <title>Audio Buttons</title>
    <style>
        body {
            background-color: #1a2129;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 2vw;
            text-align: center;
            min-height: 100vh;
            color: white;
            box-sizing: border-box;
        }
        
        h1 {
            color: white;
            margin-bottom: 5vw;
            font-weight: 600;
            letter-spacing: 0.05rem;
            text-shadow: 0 0.1rem 0.2rem rgba(0, 0, 0, 0.5);
            font-size: clamp(1.8rem, 5vw, 2.2rem);
        }
        
        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: clamp(1rem, 3vw, 1.5rem);
            max-width: 100%;
            margin: 0 auto;
        }
        
        .sound-button-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: clamp(100px, 25vw, 130px);
            margin-bottom: clamp(1.5rem, 4vw, 2rem);
        }
        
        .sound-button {
            width: 100%;
            aspect-ratio: 1/1;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            border: none;
            outline: none;
            transition: transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            background-size: cover; /* Zoom to fit without stretching */
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .sound-button::after {
            content: '';
            position: absolute;
            top: -6%;
            left: -6%;
            right: -6%;
            bottom: -6%;
            border-radius: 50%;
            z-index: -1;
            background: radial-gradient(circle at center, 
                          rgba(0,0,0,0.3) 30%, 
                          rgba(0,0,0,0.5) 70%);
        }
        
        .sound-button .button-face {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .sound-button .glossy-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, 
                          rgba(255,255,255,0.5) 0%, 
                          rgba(255,255,255,0.2) 30%, 
                          rgba(255,255,255,0) 50%);
            top: 0;
            left: 0;
        }
        
        .sound-button:active {
            transform: translateY(0.2rem);
            box-shadow: 0 0.1rem 0.3rem rgba(0,0,0,0.3);
        }
        
        .button-label {
            color: white;
            font-size: clamp(0.7rem, 2.5vw, 0.85rem);
            margin-top: 0.75rem;
            text-align: center;
            font-weight: 500;
            word-wrap: break-word;
            max-width: 100%;
        }

        /* Fallback style if no image is found */
        .sound-button.no-image {
            background: radial-gradient(circle at 30% 30%, #4a9fff 0%, #0066cc 60%, #004c99 100%);
            box-shadow: 0 0.3rem 0.5rem rgba(0, 102, 204, 0.4), inset 0 -0.2rem 0 rgba(0, 51, 153, 0.4);
        }
        
        footer {
            margin-top: clamp(2rem, 5vw, 3rem);
            color: rgba(255, 255, 255, 0.5);
            font-size: clamp(0.6rem, 2vw, 0.75rem);
            padding: 0.5rem;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { box-shadow: 0 0 0 0.5rem rgba(255, 255, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }

        .sound-button.is-playing {
            animation: pulse 2s infinite;
        }

        @media (max-width: 600px) {
            body {
                padding: 1rem;
            }

            .button-container {
                gap: 0.75rem;
            }

            .sound-button-wrapper {
                width: clamp(80px, 22vw, 100px);
                margin-bottom: 1rem;
            }

            .sound-button::after {
                top: -4%;
                left: -4%;
                right: -4%;
                bottom: -4%;
            }

            .button-label {
                font-size: clamp(0.6rem, 2.2vw, 0.75rem);
                margin-top: 0.5rem;
            }

            h1 {
                font-size: clamp(1.5rem, 4.5vw, 1.8rem);
                margin-bottom: 3vw;
            }
        }

        @media (max-width: 400px) {
            .sound-button-wrapper {
                width: clamp(70px, 20vw, 90px);
            }

            .button-label {
                font-size: clamp(0.55rem, 2vw, 0.7rem);
            }
        }
    </style>
</head>
<body>
    <h1>Audio Buttons</h1>
    
    <div class="button-container"></div>

    <footer>
        Â©Personal Collection
    </footer>

    <script>
        let currentAudio = null;
        let currentButton = null;

        function playSound(audioUrl, button) {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                if (currentButton) {
                    currentButton.classList.remove('is-playing');
                }
            }

            currentAudio = new Audio(audioUrl);
            currentButton = button;
            currentButton.classList.add('is-playing');

            currentAudio.play().catch(error => {
                console.error('Error playing audio:', error);
            });

            currentAudio.addEventListener('ended', () => {
                currentButton.classList.remove('is-playing');
                currentAudio = null;
                currentButton = null;
            });
        }

        async function loadAudioFiles() {
            const repo = 'mathesh171/Audio_Buttons';
            const audioPath = 'audio';
            const imagePath = 'images';
            const audioApiUrl = `https://api.github.com/repos/${repo}/contents/${audioPath}`;
            const imageApiUrl = `https://api.github.com/repos/${repo}/contents/${imagePath}`;

            try {
                // Fetch audio files
                const audioResponse = await fetch(audioApiUrl);
                if (!audioResponse.ok) {
                    throw new Error(`GitHub API error for audio: ${audioResponse.status}`);
                }
                const audioFiles = await audioResponse.json();
                const validAudioFiles = audioFiles.filter(file => /\.(mp3|wav|ogg)$/i.test(file.name));

                // Fetch image files
                const imageResponse = await fetch(imageApiUrl);
                if (!imageResponse.ok) {
                    throw new Error(`GitHub API error for images: ${imageResponse.status}`);
                }
                const imageFiles = await imageResponse.json();
                const validImageFiles = imageFiles.filter(file => /\.(png|jpg|jpeg)$/i.test(file.name));

                // Create a map of image filenames (without extension) to their download URLs
                const imageMap = {};
                validImageFiles.forEach(image => {
                    const imageName = image.name.replace(/\.(png|jpg|jpeg)$/i, '');
                    imageMap[imageName] = image.download_url;
                });

                const container = document.querySelector('.button-container');

                validAudioFiles.forEach(file => {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'sound-button-wrapper';

                    const button = document.createElement('button');
                    button.className = 'sound-button';
                    button.innerHTML = '<div class="button-face"></div><div class="glossy-effect"></div>';

                    // Get audio file name without extension
                    const audioName = file.name.replace(/\.(mp3|wav|ogg)$/i, '');

                    // Set background image if available
                    if (imageMap[audioName]) {
                        button.style.backgroundImage = `url(${imageMap[audioName]})`;
                    } else {
                        button.classList.add('no-image'); // Fallback to default blue button
                    }

                    button.onclick = () => playSound(file.download_url, button);

                    const label = document.createElement('div');
                    label.className = 'button-label';
                    label.textContent = audioName;

                    wrapper.appendChild(button);
                    wrapper.appendChild(label);
                    container.appendChild(wrapper);
                });
            } catch (error) {
                console.error('Error fetching files:', error);
                const container = document.querySelector('.button-container');
                container.innerHTML = '<p style="color: red;">Failed to load audio or image files. Please try again later.</p>';
            }
        }

        window.onload = loadAudioFiles;
    </script>
</body>
</html>
